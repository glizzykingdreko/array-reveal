const babel = require('@babel/core');
const plugin = require('../src/index');
const example = {
    "obfuscator.io": `function _0xd265(_0x59617d, _0x58d3c7) {
            var _0x1b87ae = _0x1b87();
            return _0xd265 = function (_0xd26557, _0x4cd01e) {
                _0xd26557 = _0xd26557 - 0x11b;
                var _0x330cd1 = _0x1b87ae[_0xd26557];
                return _0x330cd1;
            }, _0xd265(_0x59617d, _0x58d3c7);
        } (function (_0x25544e, _0x16e516) {
            var _0x3b4417 = _0xd265,
                _0x364fc2 = _0x25544e();
            while (!![]) {
                try {
                    var _0x494a4b = -parseInt(_0x3b4417(0x129)) / 0x1 * (parseInt(_0x3b4417(0x11e)) / 0x2) + parseInt(_0x3b4417(0x121)) / 0x3 * (-parseInt(_0x3b4417(0x11b)) / 0x4) + parseInt(_0x3b4417(0x128)) / 0x5 * (parseInt(_0x3b4417(0x120)) / 0x6) + -parseInt(_0x3b4417(0x11c)) / 0x7 * (-parseInt(_0x3b4417(0x126)) / 0x8) + -parseInt(_0x3b4417(0x11d)) / 0x9 + parseInt(_0x3b4417(0x123)) / 0xa * (parseInt(_0x3b4417(0x124)) / 0xb) + parseInt(_0x3b4417(0x122)) / 0xc * (-parseInt(_0x3b4417(0x127)) / 0xd);
                    if (_0x494a4b === _0x16e516) break;
                    else _0x364fc2['push'](_0x364fc2['shift']());
                } catch (_0x34e6fa) {
                    _0x364fc2['push'](_0x364fc2['shift']());
                }
            }
        }(_0x1b87, 0x5bb84));
        function hi() {
            var _0x276aaf = _0xd265;
            console[_0x276aaf(0x125)](_0x276aaf(0x11f));
        }
        hi();
        function _0x1b87() {
            var _0x1c6e3a = ['9283ydPDKF', '20xbNuMP', '4419254bQYIoY', '3910743nXzIpT', '56wRSwvq', 'Hello World!', '18096HjYQyK', '191028gmOSlo', '12lPDxUQ', '67550hRCinP', '847obxRXx', 'log', '8Kzrtej', '4524598zbufur', '970iYozwE'];
            _0x1b87 = function () {
                return _0x1c6e3a;
            };
            return _0x1b87();
        }`,
    "devina.io": `(function (_0x4198d5, _0x53916c) {
            var _0x5be880 = _0x5874,
                _0x5e2820 = _0x4198d5();
            while (!![]) {
                try {
                    var _0x47d860 = -parseInt(_0x5be880(0x155)) / 0x1 + parseInt(_0x5be880(0x151)) / 0x2 * (-parseInt(_0x5be880(0x150)) / 0x3) + parseInt(_0x5be880(0x157)) / 0x4 + -parseInt(_0x5be880(0x158)) / 0x5 * (parseInt(_0x5be880(0x14c)) / 0x6) + parseInt(_0x5be880(0x14e)) / 0x7 * (-parseInt(_0x5be880(0x14d)) / 0x8) + parseInt(_0x5be880(0x14f)) / 0x9 * (parseInt(_0x5be880(0x159)) / 0xa) + parseInt(_0x5be880(0x152)) / 0xb * (parseInt(_0x5be880(0x153)) / 0xc);
                    if (_0x47d860 === _0x53916c) break;
                    else _0x5e2820['push'](_0x5e2820['shift']());
                } catch (_0x2d2a4e) {
                    _0x5e2820['push'](_0x5e2820['shift']());
                }
            }
        }(_0x2b9a, 0xa245f));
        function _0x5874(_0x4fce5c, _0x2020db) {
            var _0x2b9a47 = _0x2b9a();
            return _0x5874 = function (_0x587487, _0x5f5844) {
                _0x587487 = _0x587487 - 0x14c;
                var _0x17ffde = _0x2b9a47[_0x587487];
                return _0x17ffde;
            }, _0x5874(_0x4fce5c, _0x2020db);
        }
        function greet() {
            var _0x1f9f06 = _0x5874;
            console[_0x1f9f06(0x156)](_0x1f9f06(0x154));
        }
        greet();
        function _0x2b9a() {
            var _0x4fb078 = ['573708iGJLhk', '8921rmsSpP', '33636unNsQf', 'Hello, World!', '638912XIHgwz', 'log', '1661772bbpPsT', '65aHMVwF', '181870jYfZLP', '342366QWZvUg', '632rBVQnp', '76706reEnhs', '252WTebMe', '3MvzhAM'];
            _0x2b9a = function () {
                return _0x4fb078;
            };
            return _0x2b9a();
        }`,
    "Code Beautify Obfuscator": `(function (_0x436725, _0x140bd2) {
            var _0x443c07 = _0x1f29,
                _0x4abdd1 = _0x436725();
            while (!![]) {
                try {
                    var _0x4cd647 = parseInt(_0x443c07(0xaf)) / (-0x1b98 * 0x1 + 0xf7 * 0x7 + 0x17 * 0xe8) + -parseInt(_0x443c07(0xb3)) / (0xcdb * -0x1 + -0x11 * -0x21 + -0x1 * -0xaac) * (-parseInt(_0x443c07(0xb2)) / (-0x219e + 0x1 * 0x20ab + 0x29 * 0x6)) + -parseInt(_0x443c07(0xad)) / (-0x88 * 0x10 + -0x20bd + 0x2941) + parseInt(_0x443c07(0xa9)) / (-0x3c * 0x3a + -0x11c5 * 0x2 + 0x3127) * (parseInt(_0x443c07(0xaa)) / (0x25e9 + 0x7eb + -0x2dce)) + parseInt(_0x443c07(0xb4)) / (0x4 * 0x47b + 0x559 + -0x55 * 0x46) + parseInt(_0x443c07(0xab)) / (0xb6f * -0x1 + -0x9ce + 0x1545) * (parseInt(_0x443c07(0xb1)) / (-0x1b08 + -0xa11 + 0x2522)) + parseInt(_0x443c07(0xac)) / (0x537 + 0x13fa * -0x1 + -0x1 * -0xecd) * (-parseInt(_0x443c07(0xb6)) / (-0x191b + 0x23c2 + -0xa9c));
                    if (_0x4cd647 === _0x140bd2) break;
                    else _0x4abdd1['push'](_0x4abdd1['shift']());
                } catch (_0x12bf2a) {
                    _0x4abdd1['push'](_0x4abdd1['shift']());
                }
            }
        }(_0x3132, 0x319cd + -0xbd0a3 + 0x866ba * 0x2));
        function _0x3132() {
            var _0x5f1036 = ['2742UbXBeQ', '24kSxfog', '13442060XuDrrJ', '111800LPEJIp', 'PfpAw', '23356pLzyNz', 'log', '365004bsFhGp', '26967SRLLRx', '116cbzeKx', '7342545fXqYQh', 'Hello Worl', '11CrkrAN', '2045KdMFCv'];
            _0x3132 = function () {
                return _0x5f1036;
            };
            return _0x3132();
        }
        function hi() {
            var _0x2c90a6 = _0x1f29,
                _0x1fe990 = {
                    'PfpAw': _0x2c90a6(0xb5) + 'd!'
                };
            console[_0x2c90a6(0xb0)](_0x1fe990[_0x2c90a6(0xae)]);
        }
        function _0x1f29(_0x114732, _0x59c602) {
            var _0x28fb41 = _0x3132();
            return _0x1f29 = function (_0x358a93, _0x32c010) {
                _0x358a93 = _0x358a93 - (-0x7 * -0x346 + -0x9 * -0x18d + -0x2436);
                var _0x10880b = _0x28fb41[_0x358a93];
                return _0x10880b;
            }, _0x1f29(_0x114732, _0x59c602);
        }
        hi();`,
    "53lu": `(function (_0x504868, _0x3eaac3) {
        var _0x39826b = _0x5b75,
            _0x489dd2 = _0x504868();
        while (!![]) {
            try {
                var _0x3dc2f5 = -parseInt(_0x39826b(0xed)) / 0x1 * (parseInt(_0x39826b(0xf4)) / 0x2) + parseInt(_0x39826b(0xeb)) / 0x3 * (-parseInt(_0x39826b(0xef)) / 0x4) + parseInt(_0x39826b(0xf1)) / 0x5 * (parseInt(_0x39826b(0xe7)) / 0x6) + -parseInt(_0x39826b(0xea)) / 0x7 + -parseInt(_0x39826b(0xf5)) / 0x8 * (-parseInt(_0x39826b(0xe9)) / 0x9) + -parseInt(_0x39826b(0xee)) / 0xa * (parseInt(_0x39826b(0xf3)) / 0xb) + parseInt(_0x39826b(0xe8)) / 0xc * (parseInt(_0x39826b(0xf2)) / 0xd);
                if (_0x3dc2f5 === _0x3eaac3) break;
                else _0x489dd2['push'](_0x489dd2['shift']());
            } catch (_0x2c9b55) {
                _0x489dd2['push'](_0x489dd2['shift']());
            }
        }
    }(_0xe1c3, 0x834ea));
    function hi() {
        var _0x359530 = _0x5b75;
        console[_0x359530(0xec)](_0x359530(0xf0));
    }
    hi();
    function _0x5b75(_0x334cce, _0x2e2293) {
        var _0xe1c384 = _0xe1c3();
        return _0x5b75 = function (_0x5b751a, _0x3ac94a) {
            _0x5b751a = _0x5b751a - 0xe7;
            var _0x4188cb = _0xe1c384[_0x5b751a];
            return _0x4188cb;
        }, _0x5b75(_0x334cce, _0x2e2293);
    }
    function _0xe1c3() {
        var _0xc8b0bb = ['276yQNIBH', 'Hello World!', '14655jFvUXq', '691028NGrMMf', '286NPXDSR', '1490758NOHMEy', '637424KaTmUv', '1458eqrmyC', '552MUPaZz', '27GkyuWh', '4579932GzekQZ', '28794GGVXla', 'log', '1uTwlCg', '306420UpJbQy'];
        _0xe1c3 = function () {
            return _0xc8b0bb;
        };
        return _0xe1c3();
    }`

};

for (const [key, value] of Object.entries(example)) {
    describe(`babel-plugin-array-reveal - ${key}`, () => {
        it('should reveal the array', () => {
            const result = babel.transform(value, { plugins: [plugin] });
            // we wanna log the new generated code
            // check if the code is valid by checking if we have a 'console["log"]' in the code
            let isValid = result.code.includes('console["log"]');
            expect(isValid).toBe(true);
        });
    });
}
